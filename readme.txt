shoval_pc algo code 